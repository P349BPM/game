import{u as T,d as P,e as E,f as N,a as B,r as p,j as e,R as D,c as O}from"./RankingService-B_uWFODL.js";const L=()=>{T();const{participants:r}=P(),{currentQuestion:n,roundOpen:o,gameStarted:a,loading:h,incrementCurrentQuestion:m,openRound:u,closeRound:l,startGame:d,stopGame:S,startNewGame:k}=E(),j=N(n),b=B(n),[C,f]=p.useState(!1),[v,R]=p.useState(""),A=()=>{const i=[["Nome","Email","Telefone","Data/Hora (locale)"],...(r||[]).map(s=>[s.name||"",s.email||"",s.phone||"",s.timestamp?new Date(s.timestamp).toLocaleString():""])].map(s=>s.map(I=>`"${String(I).replace(/"/g,'""')}"`).join(",")).join(`
`),z=new Blob([i],{type:"text/csv;charset=utf-8;"}),w=URL.createObjectURL(z),c=document.createElement("a");c.href=w,c.download=`participantes-${new Date().toISOString().slice(0,19)}.csv`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(w)};return e.jsxs("div",{style:{maxWidth:1e3,margin:"0 auto",padding:"24px"},children:[e.jsxs("div",{style:{marginBottom:12,padding:"10px 12px",borderRadius:8,background:"rgba(255,255,255,0.06)",border:"1px solid rgba(255,255,255,0.12)",color:"#c8e6c9",fontSize:14},children:["Acesse como ADMIN por este endereÃ§o: ",e.jsx("strong",{children:".../admin.html"}),". Jogadores acessam a pÃ¡gina principal."]}),e.jsxs("header",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:16},children:[e.jsxs("div",{children:[e.jsx("h1",{style:{margin:0,color:"#a5d6a7"},children:"Placar ao Vivo â€¢ Quiz"}),e.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",marginTop:6},children:[e.jsx("span",{style:{color:"#c8e6c9",fontSize:14},children:h?"Sincronizando controle...":`Pergunta liberada: ${n+1}`}),e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[e.jsx("span",{style:{width:10,height:10,borderRadius:"50%",display:"inline-block",background:o?"#66bb6a":"#ef5350",boxShadow:o?"0 0 6px #66bb6a":"0 0 6px #ef5350"}}),e.jsx("span",{style:{color:"#c8e6c9",fontSize:13},children:o?"Rodada ABERTA":"Rodada FECHADA"})]}),e.jsxs("span",{style:{color:"#c8e6c9",fontSize:13},children:["â€¢ Participantes: ",e.jsx("strong",{children:(r==null?void 0:r.length)||0})]}),e.jsxs("span",{style:{color:a?"#81c784":"#ffab91",fontSize:13},children:["â€¢ ",a?"Jogo INICIADO":"Jogo NÃƒO iniciado"]})]})]}),e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("button",{onClick:async()=>{await d()},style:g,title:"Iniciar jogo (libera a tela do quiz)",disabled:a,children:"â–¶ï¸ Iniciar Jogo"}),e.jsx("button",{onClick:async()=>{await S(),await l()},style:y,title:"Encerrar jogo (volta para tela de boas-vindas)",disabled:!a,children:"â–  Encerrar Jogo"}),e.jsx("button",{onClick:async()=>{await u()},style:g,title:"Abrir rodada (permitir respostas)",disabled:o,children:"ðŸ”“ Abrir Rodada"}),e.jsx("button",{onClick:async()=>{await l()},style:y,title:"Fechar rodada (bloquear respostas)",disabled:!o,children:"ðŸ”’ Fechar Rodada"}),e.jsx("button",{onClick:async()=>{await l(),await m()},style:x,title:"Ir para a prÃ³xima pergunta (rodada Ã© fechada ao avanÃ§ar)",children:"â–¶ï¸ PrÃ³xima Pergunta"}),e.jsx("button",{onClick:()=>{var t,i;return(i=(t=document.documentElement).requestFullscreen)==null?void 0:i.call(t)},style:x,title:"Tela cheia",children:"â›¶ Tela Cheia"}),e.jsx("button",{onClick:()=>window.location.reload(),style:x,title:"Atualizar",children:"â†» Atualizar"}),e.jsx("button",{onClick:async()=>{if(!confirm("VocÃª tem certeza? Isso vai zerar TUDO (respostas e participantes) e voltar para a questÃ£o 1."))return;const i=await k();R(`Nova partida criada (${new Date(i).toLocaleString()}). PeÃ§a para todos se cadastrarem de novo.`)},style:y,title:"Nova partida: zera respostas e participantes e volta para a questÃ£o 1",children:"ðŸ”„ Nova Partida"}),e.jsx("button",{onClick:()=>f(t=>!t),style:g,title:"Exibir/ocultar classificaÃ§Ã£o ao vivo",children:"ðŸ† Placar ao Vivo"})]})]}),v&&e.jsx("div",{style:{marginTop:-8,marginBottom:12,padding:"8px 12px",borderRadius:8,background:"rgba(255,255,255,0.08)",border:"1px solid rgba(255,255,255,0.18)",color:"#c8e6c9",fontSize:13},children:v}),e.jsx(e.Fragment,{}),e.jsxs("div",{style:{marginTop:16},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[e.jsxs("h2",{style:{margin:0,color:"#a5d6a7",fontSize:18},children:["Placar da Rodada â€¢ Pergunta ",n+1]}),e.jsxs("div",{style:{color:"#c8e6c9"},children:["Total respostas: ",e.jsx("strong",{children:j.total||0})]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:12},children:["A","B","C","D"].map((t,i)=>e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.08)",borderRadius:10,padding:"12px 14px",color:"#e8f5e9",textAlign:"center"},children:[e.jsxs("div",{style:{fontSize:13,opacity:.85},children:["OpÃ§Ã£o ",t]}),e.jsx("div",{style:{fontSize:24,fontWeight:700},children:j[i]||0})]},t))}),e.jsx("div",{style:{marginTop:8,color:"#c8e6c9",fontSize:12},children:"Atualiza em tempo real conforme os jogadores respondem. Cada jogador pode alterar sua resposta enquanto a rodada estiver ABERTA (contagem se ajusta automaticamente)."})]}),e.jsxs("div",{style:{marginTop:16},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[e.jsxs("h2",{style:{margin:0,color:"#a5d6a7",fontSize:18},children:["Participantes (",(r==null?void 0:r.length)||0,")"]}),e.jsx("div",{style:{display:"flex",gap:8},children:e.jsx("button",{onClick:A,style:x,title:"Exportar CSV",children:"â¬‡ï¸ Exportar CSV"})})]}),e.jsxs("div",{style:{background:"rgba(255,255,255,0.05)",border:"1px solid rgba(255,255,255,0.08)",borderRadius:12,overflow:"hidden"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1.2fr 0.8fr 200px",padding:"12px 16px",background:"rgba(255,255,255,0.06)",color:"#e8f5e9",fontWeight:700},children:[e.jsx("div",{children:"Nome"}),e.jsx("div",{children:"Email"}),e.jsx("div",{children:"Telefone"}),e.jsx("div",{style:{textAlign:"right"},children:"Quando"})]}),e.jsx("div",{style:{maxHeight:"40vh",overflowY:"auto"},children:r&&r.length>0?r.map(t=>e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1.2fr 0.8fr 200px",padding:"10px 16px",borderTop:"1px solid rgba(255,255,255,0.06)",color:"#c8e6c9"},children:[e.jsx("div",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),e.jsx("div",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.email}),e.jsx("div",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.phone}),e.jsx("div",{style:{textAlign:"right"},children:t.timestamp?new Date(t.timestamp).toLocaleString():"-"})]},t.id)):e.jsx("div",{style:{padding:16,color:"#c8e6c9"},children:"Nenhum participante cadastrado ainda."})})]})]}),e.jsx("footer",{style:{marginTop:16,opacity:.7,color:"#a5d6a7",fontSize:12},children:"Atualiza em tempo real via Firebase Realtime Database"}),C&&e.jsx("div",{style:V,onClick:()=>f(!1),children:e.jsxs("div",{style:F,onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:16},children:[e.jsx("h2",{style:{margin:0,color:"#e8f5e9",fontSize:22},children:"ClassificaÃ§Ã£o ao Vivo"}),e.jsx("button",{onClick:()=>f(!1),style:g,children:"âœ• Fechar"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"70px 1fr 140px 120px 140px",padding:"14px 18px",background:"rgba(255,255,255,0.08)",color:"#e8f5e9",fontWeight:700,borderRadius:10,fontSize:15},children:[e.jsx("div",{children:"#"}),e.jsx("div",{children:"Nome"}),e.jsx("div",{style:{textAlign:"right"},children:"Acertos"}),e.jsx("div",{style:{textAlign:"right"},children:"%"}),e.jsx("div",{style:{textAlign:"right"},children:"Pontos"})]}),e.jsx("div",{style:{maxHeight:"65vh",overflowY:"auto"},children:b&&b.length>0?b.map((t,i)=>e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"70px 1fr 140px 120px 140px",padding:"12px 18px",borderTop:"1px solid rgba(255,255,255,0.12)",color:i<3?"#e8f5e9":"#d5ecd6",background:i<3?"rgba(46,125,50,0.25)":"rgba(255,255,255,0.04)"},children:[e.jsxs("div",{style:{fontWeight:700},children:[i+1,"Âº"]}),e.jsx("div",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name||"(Sem nome)"}),e.jsx("div",{style:{textAlign:"right",fontVariantNumeric:"tabular-nums"},children:t.correct}),e.jsxs("div",{style:{textAlign:"right",color:"#81c784",fontVariantNumeric:"tabular-nums"},children:[(t.percentage||0).toFixed(1),"%"]}),e.jsx("div",{style:{textAlign:"right",fontVariantNumeric:"tabular-nums",fontWeight:700},children:(t.points||0).toFixed(2)})]},t.clientId||i)):e.jsx("div",{style:{padding:16,color:"#c8e6c9"},children:"Sem respostas ainda."})}),e.jsx("div",{style:{marginTop:10,color:"#c8e6c9",fontSize:12},children:"OrdenaÃ§Ã£o: Pontos (1 + bÃ´nus de tempo por acerto), depois Acertos, depois %, depois quem respondeu mais cedo."})]})})]})},x={background:"rgba(255,255,255,0.08)",color:"#e8f5e9",border:"1px solid rgba(255,255,255,0.12)",borderRadius:8,padding:"8px 12px",cursor:"pointer"},g={background:"#2e7d32",color:"#ffffff",border:"1px solid #1b5e20",borderRadius:8,padding:"8px 12px",cursor:"pointer",fontWeight:600},y={background:"#8d6e63",color:"#ffffff",border:"1px solid #6d4c41",borderRadius:8,padding:"8px 12px",cursor:"pointer"},V={position:"fixed",inset:0,background:"rgba(0,0,0,0.75)",display:"flex",alignItems:"center",justifyContent:"center",padding:16,zIndex:1e3},F={width:"min(1100px, 96vw)",background:"#112417",border:"2px solid #2e7d32",borderRadius:14,padding:18,boxShadow:"0 10px 30px rgba(0,0,0,0.5)"},W=({children:r})=>{const[n,o]=p.useState(!1),[a,h]=p.useState(""),m="801112Pm@";p.useEffect(()=>{try{sessionStorage.getItem("admin_ok")==="1"&&o(!0)}catch{}},[]);const u=d=>{if(d.preventDefault(),a===String(m)){try{sessionStorage.setItem("admin_ok","1")}catch{}o(!0)}else alert("PIN incorreto.")},l=()=>{try{sessionStorage.removeItem("admin_ok")}catch{}o(!1)};return n?e.jsxs("div",{children:[e.jsx("div",{style:{position:"fixed",right:12,top:12,zIndex:20},children:e.jsx("button",{onClick:l,style:{background:"rgba(255,255,255,0.08)",color:"#e8f5e9",border:"1px solid rgba(255,255,255,0.12)",borderRadius:8,padding:"6px 10px",cursor:"pointer"},children:"Sair"})}),r]}):e.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"#0b1f0d"},children:e.jsxs("form",{onSubmit:u,style:{width:360,background:"rgba(255,255,255,0.06)",border:"1px solid rgba(255,255,255,0.12)",borderRadius:12,padding:20,color:"#e8f5e9"},children:[e.jsx("h1",{style:{marginTop:0,marginBottom:10,color:"#a5d6a7",fontSize:22},children:"Admin â€¢ Acesso restrito"}),e.jsx("div",{style:{fontSize:13,color:"#c8e6c9",marginBottom:10},children:"Digite o PIN de administrador para entrar."}),e.jsx("input",{type:"password",placeholder:"PIN",value:a,onChange:d=>h(d.target.value),style:{width:"100%",padding:"10px 12px",borderRadius:8,border:"1px solid rgba(255,255,255,0.18)",background:"rgba(0,0,0,0.25)",color:"#e8f5e9"}}),e.jsx("button",{type:"submit",style:{marginTop:12,width:"100%",padding:"10px 12px",borderRadius:8,border:"1px solid #1b5e20",background:"#2e7d32",color:"#fff",cursor:"pointer",fontWeight:600},children:"Entrar"}),!1]})})};D.createRoot(document.getElementById("admin-root")).render(e.jsx(O.StrictMode,{children:e.jsx(W,{children:e.jsx(L,{})})}));
