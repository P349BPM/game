import{r,u as Q,a as U,q as E,j as e,b as G,s as K,R as Y,c as H}from"./RankingService-B_uWFODL.js";const J=({score:n,total:s,answeredCount:u=0,correctCount:p=0,onRestart:S})=>{const[i,b]=r.useState(""),[y,C]=r.useState(!1),[x,m]=r.useState(""),{saveScore:j}=Q(),a=U(Math.max(0,E.length-1)),v=(n/s*100).toFixed(1),w=s>0?(p/s*100).toFixed(1):"0.0",N=()=>v>=150?"ðŸ¥‡ Excelente! VocÃª Ã© um estrategista nato!":v>=120?"ðŸ¥ˆ Muito bom! Continue treinando!":v>=100?"ðŸ¥‰ Bom esforÃ§o! A prÃ¡tica leva Ã  perfeiÃ§Ã£o!":"ðŸ›¡ï¸ Continue tentando, soldado!",T=async()=>{if(!i.trim())return m("error"),!1;try{console.log("Iniciando salvamento da pontuaÃ§Ã£o...");const t=await j({name:i.trim(),score:parseFloat(n.toFixed(2)),date:new Date().toLocaleString(),percentage:v});return console.log("Resultado do salvamento:",t),C(!0),m("success"),!0}catch(t){return console.error("Erro ao salvar pontuaÃ§Ã£o:",t),m("error"),t.code&&(console.error("CÃ³digo do erro:",t.code),console.error("Mensagem do erro:",t.message)),!1}};r.useEffect(()=>{try{const t=(localStorage.getItem("player_name")||"").trim();t&&b(t)}catch{}},[]);const f=(()=>{try{return localStorage.getItem("client_id")||""}catch{return""}})(),h=(()=>{if(!Array.isArray(a)||!a.length)return-1;if(f){const t=a.findIndex(d=>d.clientId===f);if(t>=0)return t}if(i.trim()){const t=a.findIndex(d=>(d.name||"").trim()===i.trim());if(t>=0)return t}return-1})(),g=h>=0?a[h]:null;return r.useEffect(()=>{if(!i.trim()||y)return;const t=`${i.trim()}|${Number(n).toFixed(2)}|${s}`;try{if((localStorage.getItem("last_saved_score_key")||"")===t){C(!0),m("success");return}}catch{}(async()=>{try{if(await T())try{localStorage.setItem("last_saved_score_key",t)}catch{}}catch{}})()},[i,y,n,s]),r.useEffect(()=>{if(x){const t=setTimeout(()=>m(""),3e3);return()=>clearTimeout(t)}},[x]),r.useEffect(()=>{window.scrollTo(0,0)},[]),e.jsxs("div",{className:"final-screen",style:{maxWidth:"980px",margin:"2rem auto",padding:"2rem",textAlign:"center",background:"linear-gradient(180deg, #e8f5e9 0%, #f1f8e9 100%)",borderRadius:"15px",boxShadow:"0 4px 15px rgba(0, 0, 0, 0.1)",border:"2px solid #2e7d32",fontFamily:"Arial, sans-serif"},children:[e.jsx("h2",{className:"final-title",style:{color:"#1b5e20",marginBottom:"1.5rem",fontSize:"2.5rem",fontWeight:"bold",textShadow:"1px 1px 2px rgba(0,0,0,0.1)"},children:"ðŸ Fim do Quiz"}),e.jsxs("div",{style:{backgroundColor:"white",padding:"2.5rem",borderRadius:"12px",margin:"1.5rem 0",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.08)",border:"1px solid #c8e6c9",background:"linear-gradient(145deg, #ffffff, #f1f8e9)"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, minmax(0, 1fr))",gap:"12px",marginBottom:"1.2rem"},children:[e.jsxs("div",{style:P,children:[e.jsx("div",{style:q,children:"PontuaÃ§Ã£o"}),e.jsx("div",{style:M,children:n.toFixed(2)}),e.jsx("div",{style:B,children:"Com bÃ´nus de tempo"})]}),e.jsxs("div",{style:P,children:[e.jsx("div",{style:q,children:"Respondidas"}),e.jsxs("div",{style:M,children:[u," ",e.jsxs("span",{style:{fontSize:14,fontWeight:700,opacity:.75},children:["/ ",s]})]}),e.jsx("div",{style:B,children:"QuestÃµes respondidas"})]}),e.jsxs("div",{style:P,children:[e.jsx("div",{style:q,children:"Acertos"}),e.jsxs("div",{style:M,children:[p," ",e.jsxs("span",{style:{fontSize:14,fontWeight:700,opacity:.75},children:["/ ",s]})]}),e.jsxs("div",{style:B,children:[w,"% de acerto"]})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:10,flexWrap:"wrap",marginBottom:"1.2rem"},children:[e.jsxs("div",{style:O,children:["Participantes no placar: ",e.jsx("strong",{children:(a==null?void 0:a.length)||0})]}),e.jsxs("div",{style:O,children:["Sua posiÃ§Ã£o: ",e.jsx("strong",{children:h>=0?`${h+1}Âº`:"--"})]}),e.jsxs("div",{style:O,children:["% de pontuaÃ§Ã£o: ",e.jsxs("strong",{children:[v,"%"]})]})]}),e.jsx("p",{className:"final-message",style:{fontSize:"1.3rem",color:"#2e7d32",marginBottom:"1.5rem",fontStyle:"italic",fontWeight:"500"},children:N()})]}),x==="success"&&e.jsx("div",{style:{backgroundColor:"#d4edda",color:"#155724",padding:"1rem",borderRadius:"8px",margin:"1rem auto",border:"1px solid #c3e6cb",fontSize:"1.1rem",fontWeight:"500",maxWidth:"80%",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:"âœ… PontuaÃ§Ã£o salva com sucesso!"}),x==="error"&&e.jsx("div",{style:{backgroundColor:"#f8d7da",color:"#721c24",padding:"1rem",borderRadius:"8px",margin:"1rem auto",border:"1px solid #f5c6cb",fontSize:"1.1rem",fontWeight:"500",maxWidth:"80%",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:"âŒ Erro ao salvar. Tente novamente."}),y?e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"ranking-title",style:{color:"#2c3e50",margin:"2rem 0 1rem",fontSize:"1.5rem"},children:"ðŸ† ClassificaÃ§Ã£o dos Comandantes"}),e.jsx("div",{style:{margin:"0 auto 10px",maxWidth:920,padding:"10px 12px",borderRadius:10,border:"1px solid rgba(46,125,50,0.25)",background:"rgba(46,125,50,0.06)",color:"#1b5e20",fontWeight:600,textAlign:"left"},children:g?e.jsxs(e.Fragment,{children:["VocÃª estÃ¡ em ",e.jsxs("strong",{children:[h+1,"Âº"]})," com ",e.jsx("strong",{children:Number(g.points||0).toFixed(2)})," pontos â€” ",g.correct,"/",s," acertos"]}):e.jsx(e.Fragment,{children:"Placar geral (todos os participantes)"})}),e.jsxs("div",{style:{maxWidth:920,margin:"0 auto",border:"1px solid rgba(0,0,0,0.08)",borderRadius:12,overflow:"hidden",background:"#fff"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"80px 1fr 140px 150px 140px",gap:0,padding:"12px 14px",background:"linear-gradient(90deg, #1b5e20, #2e7d32)",color:"#fff",fontWeight:700,fontSize:13,textTransform:"uppercase",letterSpacing:.6},children:[e.jsx("div",{children:"Pos."}),e.jsx("div",{children:"Nome"}),e.jsx("div",{style:{textAlign:"right"},children:"Pontos"}),e.jsx("div",{style:{textAlign:"right"},children:"Acertos"}),e.jsx("div",{style:{textAlign:"right"},children:"% acerto"})]}),e.jsx("div",{style:{maxHeight:420,overflowY:"auto"},children:(a||[]).length?a.map((t,d)=>{const k=f&&t.clientId===f||i.trim()&&(t.name||"").trim()===i.trim(),W=k?"rgba(255, 243, 205, 0.65)":d%2===0?"#ffffff":"rgba(46,125,50,0.03)";return e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"80px 1fr 140px 150px 140px",padding:"11px 14px",borderTop:"1px solid rgba(0,0,0,0.06)",background:W,alignItems:"center"},children:[e.jsxs("div",{style:{fontWeight:800,color:"#1b5e20"},children:[d+1,"Âº"]}),e.jsxs("div",{style:{textAlign:"left",fontWeight:k?800:600,color:"#263238",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[t.name||"â€”"," ",k?"(vocÃª)":""]}),e.jsx("div",{style:{textAlign:"right",fontVariantNumeric:"tabular-nums",fontWeight:800,color:"#1b5e20"},children:Number(t.points||0).toFixed(2)}),e.jsxs("div",{style:{textAlign:"right",fontVariantNumeric:"tabular-nums",fontWeight:700,color:"#455a64"},children:[t.correct,"/",s]}),e.jsxs("div",{style:{textAlign:"right",fontVariantNumeric:"tabular-nums",fontWeight:800,color:"#2e7d32"},children:[Number(t.percentage||0).toFixed(1),"%"]})]},t.clientId||d)}):e.jsx("div",{style:{padding:16,color:"#607d8b",fontStyle:"italic"},children:"Ainda nÃ£o hÃ¡ respostas registradas."})})]})]}):e.jsx("div",{className:"save-score",children:e.jsx("p",{style:{margin:"1.5rem 0 0",color:"#2e7d32",fontWeight:600},children:"Salvando pontuaÃ§Ã£o automaticamente..."})}),e.jsx("div",{style:{marginTop:"2rem"},children:e.jsxs("button",{className:"restart-btn",onClick:S,style:{padding:"0.9rem 2rem",fontSize:"1.2rem",backgroundColor:"#1b5e20",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",transition:"all 0.3s",fontWeight:"600",boxShadow:"0 4px 8px rgba(0,0,0,0.1)",display:"inline-flex",alignItems:"center",gap:"0.5rem"},onMouseOver:t=>{t.target.style.backgroundColor="#0d4712",t.target.style.transform="translateY(-2px)",t.target.style.boxShadow="0 6px 12px rgba(0,0,0,0.15)"},onMouseOut:t=>{t.target.style.backgroundColor="#1b5e20",t.target.style.transform="translateY(0)",t.target.style.boxShadow="0 4px 8px rgba(0,0,0,0.1)"},children:[e.jsx("span",{children:"ðŸ”„"})," RecomeÃ§ar Batalha"]})})]})},P={border:"1px solid rgba(46,125,50,0.18)",borderRadius:12,padding:"14px 14px",background:"rgba(46,125,50,0.03)"},q={fontSize:12,textTransform:"uppercase",letterSpacing:.7,color:"#2e7d32",fontWeight:800},M={marginTop:6,fontSize:26,color:"#1b5e20",fontWeight:900},B={marginTop:4,fontSize:12,color:"#455a64",fontWeight:600},O={padding:"8px 10px",borderRadius:999,border:"1px solid rgba(46,125,50,0.25)",background:"rgba(46,125,50,0.05)",color:"#1b5e20",fontWeight:600},X=({onRegistered:n})=>{const[s,u]=r.useState(""),[p,S]=r.useState(""),[i,b]=r.useState(""),[y,C]=r.useState(!1),x=async m=>{m.preventDefault(),S(""),b("");try{await G({name:s}),S("success"),b("Cadastro realizado!"),localStorage.setItem("player_name",s.trim()),C(!0);try{n==null||n(s.trim())}catch{}}catch(j){S("error"),b((j==null?void 0:j.message)||"Erro ao cadastrar. Verifique os campos.")}};return y?e.jsxs("div",{style:{maxWidth:760,margin:"2rem auto",padding:"2.5rem",background:"rgba(255,255,255,0.06)",border:"1px solid rgba(255,255,255,0.12)",borderRadius:14,color:"#e8f5e9",textAlign:"center"},children:[e.jsx("h2",{style:{marginTop:0,color:"#a5d6a7",fontSize:"2.2rem"},children:"Game Adrenalina Policial"}),e.jsx("p",{style:{fontSize:"1.3rem",marginTop:8},children:"Cadastro concluÃ­do. Iniciando..."}),e.jsx("p",{style:{fontSize:"1.6rem",marginTop:4,color:"#ffd54f",fontWeight:700},children:"VÃ¡ e venÃ§a!"}),e.jsx("div",{style:{marginTop:24,padding:"12px 14px",borderRadius:10,border:"1px dashed rgba(255,255,255,0.25)",color:"#c8e6c9"},children:"VocÃª jÃ¡ pode iniciar o quiz."})]}):e.jsxs("div",{style:{maxWidth:760,margin:"2rem auto",padding:"2rem",background:"rgba(255,255,255,0.06)",border:"1px solid rgba(255,255,255,0.12)",borderRadius:14,color:"#e8f5e9"},children:[e.jsx("h2",{style:{marginTop:0,marginBottom:8,color:"#a5d6a7",fontSize:"2rem"},children:"Game Adrenalina Policial"}),e.jsx("p",{style:{marginTop:0,opacity:.9},children:"Informe seu nome para registrar no placar e iniciar."}),e.jsxs("form",{onSubmit:x,style:{display:"grid",gap:12,marginTop:16},children:[e.jsx("input",{type:"text",placeholder:"Seu nome",value:s,onChange:m=>u(m.target.value),maxLength:60,required:!0,style:Z}),e.jsx("button",{type:"submit",style:ee,disabled:!s.trim(),children:"Iniciar"})]}),p&&e.jsx("div",{style:{marginTop:16,padding:"10px 12px",borderRadius:8,background:p==="success"?"rgba(76,175,80,0.15)":"rgba(244,67,54,0.15)",border:`1px solid ${p==="success"?"rgba(76,175,80,0.35)":"rgba(244,67,54,0.35)"}`,color:p==="success"?"#c8e6c9":"#ffcdd2"},children:i}),e.jsx("div",{style:{marginTop:20,padding:"10px 12px",borderRadius:8,border:"1px dashed rgba(255,255,255,0.25)",color:"#c8e6c9"},children:"O tempo mÃ¡ximo por questÃ£o Ã© de 4 minutos."})]})},Z={padding:"12px 14px",borderRadius:8,border:"1px solid rgba(255,255,255,0.15)",background:"rgba(0,0,0,0.25)",color:"#e8f5e9",outline:"none"},ee={padding:"12px 16px",borderRadius:8,border:"1px solid #1b5e20",background:"#2e7d32",color:"#fff",cursor:"pointer",fontWeight:600},I=240,V={correct:"https://www.soundjay.com/buttons/sounds/button-09.mp3",wrong:"https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3"};function te(){const[n,s]=r.useState(0),[u,p]=r.useState(()=>{try{return!!(localStorage.getItem("player_name")||"").trim()}catch{return!1}}),[S,i]=r.useState(null),[b,y]=r.useState(0),[C,x]=r.useState(0),[m,j]=r.useState(0),[a,v]=r.useState(!1),[w,N]=r.useState(I),[T,f]=r.useState(!1),[h,g]=r.useState(!1),[t,d]=r.useState(null),[k,W]=r.useState(!1),c=E[n]||null,z=l=>{try{let o;if(l)try{o=require("./assets/correct.mp3")}catch{o=V.correct}else try{o=require("./assets/wrong.mp3")}catch{o=V.wrong}const A=new Audio(o);A.volume=.5,A.play().catch(F=>console.log("Erro ao reproduzir som:",F))}catch(o){console.log("Erro no sistema de Ã¡udio:",o)}};r.useEffect(()=>{if(!u||T||h||!c||a)return;const l=setInterval(()=>{N(o=>o<=1?(clearInterval(l),f(!0),g(!0),z(!1),0):o-1)},1e3);return()=>clearInterval(l)},[n,T,h,c,u,a]),r.useEffect(()=>{if(u&&c&&!a){N(I),i(null),f(!1),g(!1),d(null),W(!0);const l=setTimeout(()=>W(!1),350);return()=>clearTimeout(l)}},[n,c,u,a]),r.useEffect(()=>{i(null)},[n]),r.useEffect(()=>{v(n>=E.length)},[n]);const _=()=>{s(l=>l+1)};r.useEffect(()=>{if(!u||a||!c||w!==0||t!==null)return;d(0);const l=setTimeout(()=>{g(!1),_()},900);return()=>clearTimeout(l)},[w,u,a,c,t]);const D=l=>{if(T||!c||a)return;i(l),f(!0),g(!0);try{K({questionIndex:n,optionIndex:l,timeLeft:w,timerDuration:I})}catch{}const o=l===c.correctAnswer,A=Math.max(0,Math.min(1,w/I)),F=o?1+A:0;z(!!o),y(R=>R+F),x(R=>R+1),o&&j(R=>R+1),d(F),setTimeout(()=>{g(!1),_()},900)},L=()=>{y(0),x(0),j(0),v(!1),g(!1),s(0),N(I),i(null),f(!1),d(null)},$=["A","B","C","D","E"];return u?e.jsxs("div",{className:"app-container",children:[e.jsx("h1",{className:"title",children:"Quiz - VÃ¡ e venÃ§a, sem medo!"}),a?e.jsx(J,{score:b,total:E.length,answeredCount:C,correctCount:m,onRestart:L}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"top-bar",children:[e.jsxs("div",{className:"score",children:["ðŸŽ¯ PontuaÃ§Ã£o: ",b.toFixed(2)]}),e.jsxs("div",{className:"timer",children:["â±ï¸ ",c?`${w}s`:"--"]})]}),e.jsxs("div",{className:"question-box",children:[e.jsx("h2",{className:"question-text",children:c?c.question:"Finalizando..."}),e.jsx("div",{className:"options",children:c&&c.options.map((l,o)=>e.jsxs("button",{onClick:()=>D(o),disabled:T,className:`option-btn ${S===o?o===c.correctAnswer?"correct":"incorrect":""}`,style:{pointerEvents:k?"none":"auto"},children:[e.jsxs("span",{className:"letter",children:[$[o],"."]})," ",l]},o))}),h&&e.jsxs("div",{style:{marginTop:"20px",padding:"10px 20px",fontSize:"1.1rem",backgroundColor:"rgba(255,255,255,0.1)",color:"#FFFFFF",border:"1px solid rgba(255,255,255,0.2)",borderRadius:"8px"},children:["â³ AvanÃ§ando automaticamente...",t!==null&&e.jsx("div",{style:{marginTop:8,fontSize:"0.95rem",color:t>0?"#81c784":"#ffcdd2"},children:t>0?`+${t.toFixed(2)} pontos`:"+0.00 pontos"})]})]})]})]}):e.jsxs("div",{className:"app-container",children:[e.jsx("h1",{className:"title",children:"Quiz - VÃ¡ e venÃ§a, sem medo!"}),e.jsx(X,{onRegistered:()=>p(!0)})]})}const re=r.createContext(),se=({children:n})=>{const[s]=r.useState({powerUps:{extraTime:2},stats:{correct:0,wrong:0}});return e.jsx(re.Provider,{value:{gameState:s},children:n})};Y.createRoot(document.getElementById("root")).render(e.jsx(H.StrictMode,{children:e.jsx(se,{children:e.jsx(te,{})})}));
